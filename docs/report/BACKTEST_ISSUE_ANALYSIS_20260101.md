# å›æµ‹æ•°æ®/ä»£ç /ç­–ç•¥å±‚é¢é—®é¢˜æ·±åº¦åˆ†ææŠ¥å‘Š

**åˆ†ææ—¥æœŸ**: 2026-01-01
**åˆ†æè€…**: Claude Code
**å›æµ‹å‘¨æœŸ**: 20240601 ~ 20241231
**æœ‰æ•ˆæ•°æ®**: 6ä¸ªè°ƒä»“æœŸ (æ’é™¤20241231)

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

### æ ¸å¿ƒå‘ç°
1. **æ•°æ®å±‚é¢**: 20241231æœŸæ•°æ®ä¸å®Œæ•´ï¼ˆç¼ºå°‘ä¸‹æœˆæ”¶ç›Šç‡ï¼‰
2. **ä»£ç å±‚é¢**: åŠ¨æ€ç¼“å†²ç­–ç•¥æ­£ç¡®ï¼Œä½†è¾¹ç•Œæ¡ä»¶å¤„ç†æœ‰ç¼ºé™·
3. **ç­–ç•¥å±‚é¢**: å› å­æœ‰æ•ˆæ€§å­˜åœ¨ï¼Œä½†ICç¨³å®šæ€§å·®ï¼Œæ¢æ‰‹ç‡è¿‡é«˜

### é£é™©ç­‰çº§
- ğŸ”´ **é«˜é£é™©**: ICIRè¿‡ä½ (0.45)ï¼Œå› å­ä¸ç¨³å®š
- ğŸŸ¡ **ä¸­é£é™©**: æ¢æ‰‹ç‡è¿‡é«˜ (90.4%)ï¼Œäº¤æ˜“æˆæœ¬ä¾µèš€æ”¶ç›Š
- ğŸŸ¡ **ä¸­é£é™©**: å¤šç©ºç»„åˆè¡¨ç°å¼± (ç´¯è®¡ä»…1.56%)
- ğŸŸ¢ **ä½é£é™©**: æ•°æ®å®Œæ•´æ€§é—®é¢˜ï¼ˆå·²è¯†åˆ«ï¼‰

---

## ä¸€ã€æ•°æ®å±‚é¢é—®é¢˜

### 1.1 20241231æ•°æ®ä¸å®Œæ•´

**é—®é¢˜æè¿°**:
```
20241231æœŸ:
  - è°ƒä»“æ—¥: 20241231
  - ä¸‹ä¸ªè°ƒä»“æ—¥: 20250131
  - å›æµ‹ç»“æŸ: 20241231
  - ç»“æœ: æ— æ³•è·å–ä¸‹æœˆæ”¶ç›Šç‡ï¼Œæ‰€æœ‰æ”¶ç›Šä¸º0
```

**æ ¹æœ¬åŸå› **:
- å›æµ‹ç»“æŸæ—¥æœŸè®¾ä¸º20241231
- ä½†éœ€è¦20250131çš„æ•°æ®è®¡ç®—20241231æœŸæ”¶ç›Š
- è¶…å‡ºå›æµ‹èŒƒå›´ï¼Œå¯¼è‡´æ•°æ®ç¼ºå¤±

**å½±å“**:
- 20241231æœŸæ”¶ç›Šã€ICå€¼ã€æ¢æ‰‹ç‡å‡ä¸º0æˆ–NaN
- è¯¥æœŸæ•°æ®æ— æ³•ç”¨äºç»Ÿè®¡åˆ†æ
- ä½†ä¸å½±å“å‰6æœŸçš„æœ‰æ•ˆæ€§

**è§£å†³æ–¹æ¡ˆ**:
```python
# æ–¹æ¡ˆ1: è°ƒæ•´å›æµ‹ç»“æŸæ—¥æœŸ
end_date = '20241130'  # é¿å…æœ€åä¸€æœŸä¸å®Œæ•´

# æ–¹æ¡ˆ2: å»¶é•¿å›æµ‹å‘¨æœŸ
end_date = '20250131'  # è·å–å®Œæ•´æ•°æ®

# æ–¹æ¡ˆ3: æ ‡è®°ä¸å®Œæ•´æ•°æ®
if next_rebalance > end_date:
    skip_period = True  # è·³è¿‡æœ€åä¸€æœŸ
```

### 1.2 äº¤æ˜“æ—¥æ•°æ®å……è¶³æ€§

**20241231å‰34å¤©äº¤æ˜“æ—¥ç»Ÿè®¡**:
```
20241127 ~ 20241231: 25å¤©  âœ— (ä¸è¶³34å¤©)
20241107 ~ 20241231: 39å¤©  âœ“ (åŸºç¡€ç¼“å†²)
20241028 ~ 20241231: 47å¤©  âœ“ (é¢å¤–ç¼“å†²10å¤©)
20241018 ~ 20241231: 53å¤©  âœ“ (é¢å¤–ç¼“å†²20å¤©)
20241008 ~ 20241231: 61å¤©  âœ“ (é¢å¤–ç¼“å†²30å¤©)
20240927 ~ 20241231: 63å¤©  âœ“ (é¢å¤–ç¼“å†²40å¤©)
```

**ç»“è®º**: åŠ¨æ€ç¼“å†²ç­–ç•¥æ­£ç¡®ï¼Œä½†20241231ä½œä¸ºç»ˆç‚¹æ— æ³•åº”ç”¨ç¼“å†²

### 1.3 æ•°æ®æºåˆ†ç¦»éªŒè¯

**å„æ•°æ®æºå®Œæ•´æ€§**:
```
æ—¥æœŸ        ä¸ªè‚¡æ•°æ®    æŒ‡æ•°æ•°æ®    STæ•°æ®    çŠ¶æ€
20240628    5301åª      1æ¡        146åª     âœ“
20240731    5304åª      1æ¡        138åª     âœ“
20240830    5312åª      1æ¡        126åª     âœ“
20240930    5320åª      1æ¡        124åª     âœ“
20241031    5324åª      1æ¡        121åª     âœ“
20241129    5337åª      1æ¡        126åª     âœ“
20241231    5344åª      1æ¡        128åª     âœ“
```

**éªŒè¯**: æ•°æ®æºåˆ†ç¦»å¤„ç†æ­£ç¡® âœ“

---

## äºŒã€ä»£ç å±‚é¢é—®é¢˜

### 2.1 åŠ¨æ€ç¼“å†²ç­–ç•¥è¾¹ç•Œæ¡ä»¶

**å½“å‰å®ç°**:
```python
def get_price_data_for_period_fixed(self, stocks, target_date, lookback_days):
    initial_start_dt = target_dt - timedelta(days=lookback_days + 20)

    if len(trading_days) < lookback_days:
        extra_buffer = 0
        while len(trading_days) < lookback_days and extra_buffer < 100:
            extra_buffer += 10
            new_start_dt = target_dt - timedelta(days=lookback_days + 20 + extra_buffer)
            # é‡æ–°æŸ¥è¯¢...
```

**é—®é¢˜**:
- å½“target_dateæ˜¯å›æµ‹ç»ˆç‚¹æ—¶ï¼Œæ— æ³•è·å–ä¸‹æœˆæ•°æ®
- åŠ¨æ€ç¼“å†²è™½ç„¶ç¡®ä¿äº†æ•°æ®å……è¶³ï¼Œä½†æ— æ³•è§£å†³ç»ˆç‚¹é—®é¢˜

**å»ºè®®æ”¹è¿›**:
```python
def get_price_data_for_period_fixed(self, stocks, target_date, lookback_days):
    # æ£€æŸ¥æ˜¯å¦è¶…å‡ºå›æµ‹èŒƒå›´
    if target_date >= self.end_date:
        logger.warning(f"  {target_date} è¶…å‡ºå›æµ‹èŒƒå›´ï¼Œè·³è¿‡")
        return pd.DataFrame()

    # åŸæœ‰ç¼“å†²é€»è¾‘...
```

### 2.2 å› å­è®¡ç®—æ¥å£å…¼å®¹æ€§

**å„å› å­æ­£ç¡®æ¥å£**:
```python
# alpha_peg - ä½¿ç”¨get_fina_data âœ“
df_pe, _ = data_loader.get_fina_data(base_stocks, rebalance_date)

# alpha_010/038/120cq - ä½¿ç”¨get_price_data_for_period âœ“
price_data = data_loader.get_price_data_for_period(base_stocks, rebalance_date, days)

# cr_qfq - ä½¿ç”¨calculate_by_period âœ“
cr_qfq_result = cr_qfq_factor.calculate_by_period(rebalance_date, base_stocks)
```

**éªŒè¯**: æ¥å£è°ƒç”¨æ­£ç¡® âœ“

### 2.3 æ”¶ç›Šè®¡ç®—æ—¶é—´å¯¹é½

**æŠ•èµ„ç»„åˆæ”¶ç›Š**:
```python
def get_next_month_return_fixed(self, current_date, stocks, rebalance_dates, idx):
    if idx >= len(rebalance_dates) - 1:
        next_rebalance = self.end_date  # é—®é¢˜ç‚¹
    else:
        next_rebalance = rebalance_dates[idx + 1]
```

**åŸºå‡†æ”¶ç›Š**:
```python
def get_benchmark_return_fixed(self, current_date, next_rebalance_date):
    # ä½¿ç”¨ä¼ å…¥çš„next_rebalance_date
    actual_current = get_nearest_index_day(current_date)
    actual_next = get_nearest_index_day(next_rebalance_date)
```

**é—®é¢˜**: å½“next_rebalance = self.end_dateæ—¶ï¼Œä¸¤è€…ç›¸ç­‰ï¼Œæ— æ³•è®¡ç®—æ”¶ç›Š

**æ”¹è¿›æ–¹æ¡ˆ**:
```python
if idx >= len(rebalance_dates) - 1:
    # æœ€åä¸€æœŸï¼Œè·³è¿‡æˆ–ä½¿ç”¨end_dateä½œä¸ºä¸‹ä¸ªè°ƒä»“æ—¥
    # ä½†éœ€è¦ç¡®ä¿end_dateåœ¨æŒ‡æ•°æ•°æ®ä¸­å­˜åœ¨
    next_rebalance = self.end_date
    # æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹æœŸæ•°æ®
    if next_rebalance == current_date:
        logger.warning(f"  {current_date} æ— ä¸‹æœŸæ•°æ®ï¼Œè·³è¿‡")
        return pd.DataFrame()
```

### 2.4 ç±»å‹è½¬æ¢é—®é¢˜

**å·²ä¿®å¤**:
```python
# ç´¯è®¡æ”¶ç›Š
r_float = float(r) if hasattr(r, '__float__') else r

# æ³¢åŠ¨ç‡è®¡ç®—
returns_float = [float(r) if hasattr(r, '__float__') else r for r in returns]

# èƒœç‡è®¡ç®—
returns_float = [float(r) if hasattr(r, '__float__') else r for r in returns]
```

**éªŒè¯**: ç±»å‹è½¬æ¢å·²ä¿®å¤ âœ“

### 2.5 æ•°æ®å¡«å……é€»è¾‘

**ICå€¼å¡«å……**:
```python
ic_values = results['ic_values'] if results['ic_values'] else []
if len(ic_values) < len(results['dates']):
    ic_values = ic_values + [0] * (len(results['dates']) - len(ic_values))
```

**é—®é¢˜**: ç”¨0å¡«å……NaNä¸åˆç†ï¼Œåº”è¯¥ç”¨NaNæˆ–æ ‡è®°ä¸ºæ— æ•ˆ

**æ”¹è¿›**:
```python
# ä¿æŒåŸå§‹é•¿åº¦ï¼Œä¸å¡«å……
# æˆ–åœ¨DataFrameä¸­ä½¿ç”¨NaN
ic_values = results['ic_values']
# ä¿å­˜æ—¶å…è®¸é•¿åº¦ä¸ä¸€è‡´ï¼Œç”¨NaNè¡¨ç¤ºç¼ºå¤±
```

---

## ä¸‰ã€ç­–ç•¥å±‚é¢é—®é¢˜

### 3.1 å› å­æœ‰æ•ˆæ€§åˆ†æ

**ICç»Ÿè®¡ (6æœŸ)**:
```
æŒ‡æ ‡        æ•°å€¼        è¯„ä»·
å‡å€¼        0.0502      åä½
æ ‡å‡†å·®      0.1125      è¾ƒé«˜
IR          0.4463      è¿‡ä½ (< 0.5)
æ­£å€¼æ¯”ä¾‹    83.3%       è‰¯å¥½
å˜å¼‚ç³»æ•°    2.24        è¿‡é«˜ (> 2)
```

**é—®é¢˜è¯Šæ–­**:
- âœ… å› å­æ–¹å‘æ­£ç¡® (83.3%æ­£å€¼)
- âŒ å› å­ç¨³å®šæ€§å·® (IRè¿‡ä½)
- âŒ å› å­æ³¢åŠ¨å¤§ (å˜å¼‚ç³»æ•°é«˜)

**ICè¡°å‡åˆ†æ**:
```
å‰åŠæ®µå‡å€¼: 0.1289
ååŠæ®µå‡å€¼: -0.0285
è¡°å‡ç¨‹åº¦: -0.1574
```

**ç»“è®º**: å› å­æœ‰æ•ˆæ€§éšæ—¶é—´è¡°å‡æ˜æ˜¾

### 3.2 æ”¶ç›Šè¡¨ç°åˆ†æ

**å„ç»„ç´¯è®¡æ”¶ç›Š**:
```
ç»„åˆ«    ç´¯è®¡æ”¶ç›Š    å¹³å‡æ”¶ç›Š    å¤æ™®    èƒœç‡    æœ€å¤§å›æ’¤
ç»„1     22.37%     3.79%     1.44   66.7%   4.0%
ç»„2     24.46%     4.10%     1.52   66.7%   3.8%
ç»„3     17.97%     3.12%     1.27   66.7%   3.9%
ç»„4     23.37%     3.88%     1.61   66.7%   4.3%
ç»„5     20.38%     3.31%     1.93   66.7%   3.6%
åŸºå‡†     13.67%     2.48%     1.02   50.0%   4.1%
å¤šç©º      1.56%     0.49%     0.25   66.7%  12.0%
```

**å…³é”®å‘ç°**:
1. **æ‰€æœ‰ç»„åˆ«è·‘èµ¢åŸºå‡†**: ç»„1-5ç´¯è®¡æ”¶ç›Šå‡ > 13.67%
2. **ä½†å¤šç©ºç»„åˆä»…1.56%**: è¯´æ˜ç»„1å’Œç»„5æ”¶ç›Šæ¥è¿‘ï¼Œåˆ†å±‚æ•ˆæœå¼±
3. **ç»„5å¤æ™®æœ€é«˜ (1.93)**: ä½†ç´¯è®¡æ”¶ç›Šä¸æ˜¯æœ€é«˜ï¼Œè¯´æ˜é£é™©è°ƒæ•´åè¡¨ç°å¥½
4. **å¤šç©ºå›æ’¤12%**: è¿œé«˜äºå„ç»„ï¼Œè¯´æ˜æ–¹å‘ç›¸åæ—¶æŸå¤±å¤§

### 3.3 æ¢æ‰‹ç‡é—®é¢˜

**å¹³å‡æ¢æ‰‹ç‡**: 90.4%

**å½±å“åˆ†æ**:
```
å‡è®¾äº¤æ˜“æˆæœ¬: 0.25% (0.05%ä½£é‡‘ + 0.1%å°èŠ±ç¨ + 0.1%æ»‘ç‚¹)
å¹´åŒ–æ¢æ‰‹: 90.4% Ã— 12 = 1085%
å¹´åŒ–äº¤æ˜“æˆæœ¬: 1085% Ã— 0.25% = 2.71%

ç»„1å¹´åŒ–æ”¶ç›Š: 3.79% Ã— 12 = 45.48%
æ‰£é™¤æˆæœ¬å: 45.48% - 2.71% = 42.77%
```

**é—®é¢˜**: äº¤æ˜“æˆæœ¬ä¾µèš€çº¦6%çš„æ”¶ç›Š

### 3.4 é€æœŸè¡¨ç°å¼‚å¸¸

**è¡¨ç°æœ€å¥½**: 20240830
```
åŸºå‡†: 20.97%
å¤šç©º: 10.53%
IC: 0.185
æœ€ä¼˜ç»„: Group_2 (24.40%)
```

**è¡¨ç°æœ€å·®**: 20240930
```
åŸºå‡†: -3.16%
å¤šç©º: -12.03%
IC: -0.165
æœ€ä¼˜ç»„: Group_5 (9.88%)
```

**å¼‚å¸¸åˆ†æ**:
- 20240930å¤šç©ºç»„åˆ-12.03%ï¼Œä½†æœ€ä¼˜ç»„æ˜¯Group_5 (9.88%)
- è¯´æ˜Group_1è¡¨ç°æå·®ï¼Œå¯èƒ½æ˜¯å› å­æ–¹å‘é”™è¯¯
- è¯¥æœŸICä¸ºè´Ÿå€¼ (-0.165)ï¼Œå› å­ä¿¡å·ä¸æ”¶ç›Šè´Ÿç›¸å…³

### 3.5 é£é™©è°ƒæ•´åæ”¶ç›Š

**Calmaræ¯”ç‡** (ç´¯è®¡æ”¶ç›Š/æœ€å¤§å›æ’¤):
```
ç»„1:  22.37% / 4.0% = 5.55
ç»„2:  24.46% / 3.8% = 6.36  âœ“ æœ€ä½³
ç»„3:  17.97% / 3.9% = 4.66
ç»„4:  23.37% / 4.3% = 5.38
ç»„5:  20.38% / 3.6% = 5.71
åŸºå‡†: 13.67% / 4.1% = 3.37
å¤šç©º:  1.56% / 12.0% = 0.13  âœ— æå·®
```

**ç»“è®º**:
- ç»„2é£é™©è°ƒæ•´åè¡¨ç°æœ€ä½³
- å¤šç©ºç»„åˆé£é™©æé«˜ï¼Œæ”¶ç›Šæ— æ³•è¦†ç›–é£é™©

---

## å››ã€ç»¼åˆé—®é¢˜æ¸…å•

### ğŸ”´ é«˜ä¼˜å…ˆçº§é—®é¢˜

| # | é—®é¢˜ | å½±å“ | åŸå›  | å»ºè®® |
|---|------|------|------|------|
| 1 | ICIRè¿‡ä½ (0.45) | å› å­ä¸ç¨³å®š | å› å­æœ‰æ•ˆæ€§è¡°å‡ | ä¼˜åŒ–å› å­æˆ–å¢åŠ ç­›é€‰ |
| 2 | æ¢æ‰‹ç‡è¿‡é«˜ (90.4%) | äº¤æ˜“æˆæœ¬é«˜ | é¢‘ç¹è°ƒä»“ | é™ä½æ¢æ‰‹æˆ–ä¼˜åŒ–æˆæœ¬ |
| 3 | å¤šç©ºç»„åˆå¼± (1.56%) | ç­–ç•¥æ— æ•ˆ | åˆ†å±‚ä¸æ˜æ˜¾ | ä¼˜åŒ–åˆ†ç»„é€»è¾‘ |

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§é—®é¢˜

| # | é—®é¢˜ | å½±å“ | åŸå›  | å»ºè®® |
|---|------|------|------|------|
| 4 | 20241231æ•°æ®ç¼ºå¤± | ç»Ÿè®¡åå·® | å›æµ‹è®¾è®¡ | è°ƒæ•´ç»“æŸæ—¥æœŸ |
| 5 | ICå€¼è¡°å‡æ˜æ˜¾ | å› å­æ—¶æ•ˆæ€§ | å¸‚åœºå˜åŒ– | åŠ¨æ€è°ƒæ•´å› å­ |
| 6 | ç»„1è·‘è¾“ç»„5 | åˆ†å±‚åå‘ | å› å­æ–¹å‘ | æ£€æŸ¥å› å­ç¬¦å· |

### ğŸŸ¢ ä½ä¼˜å…ˆçº§é—®é¢˜

| # | é—®é¢˜ | å½±å“ | åŸå›  | å»ºè®® |
|---|------|------|------|------|
| 7 | ç±»å‹è½¬æ¢è­¦å‘Š | ä»£ç å†—ä½™ | Decimalç±»å‹ | ç»Ÿä¸€æ•°æ®ç±»å‹ |
| 8 | ICå¡«å……é€»è¾‘ | æ•°æ®å¤±çœŸ | è¾¹ç•Œå¤„ç† | ä½¿ç”¨NaNå¡«å…… |

---

## äº”ã€æ”¹è¿›å»ºè®®

### 5.1 æ•°æ®å±‚é¢

```python
# æ”¹è¿›1: è°ƒæ•´å›æµ‹å‘¨æœŸ
class SixFactorBacktestFixed:
    def __init__(self, start_date: str, end_date: str):
        # ç¡®ä¿end_dateæ˜¯è°ƒä»“æ—¥ï¼Œä¸”æœ‰ä¸‹æœŸæ•°æ®
        self.end_date = self.get_last_rebalance_with_next(end_date)

# æ”¹è¿›2: å¢åŠ æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
def run_backtest(self):
    for idx, rebalance_date in enumerate(rebalance_dates):
        # æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹æœŸæ•°æ®
        if idx == len(rebalance_dates) - 1:
            logger.warning(f"æœ€åä¸€æœŸ {rebalance_date}ï¼Œè·³è¿‡")
            continue
        # æ­£å¸¸å¤„ç†...
```

### 5.2 ä»£ç å±‚é¢

```python
# æ”¹è¿›1: ä¼˜åŒ–åŠ¨æ€ç¼“å†²
def get_price_data_for_period_fixed(self, stocks, target_date, lookback_days):
    # æ£€æŸ¥æ˜¯å¦è¶…å‡ºå›æµ‹èŒƒå›´
    if target_date >= self.end_date:
        return pd.DataFrame()

    # åŠ¨æ€ç¼“å†²é€»è¾‘
    buffer_days = 20
    while True:
        start_date = (target_date - timedelta(days=lookback_days + buffer_days)).strftime('%Y%m%d')
        trading_days = self.count_trading_days(start_date, target_date)

        if trading_days >= lookback_days:
            return data_loader.get_price_data(stocks, start_date, target_date)

        buffer_days += 10
        if buffer_days > 100:
            logger.warning(f"æ— æ³•ä¸º {target_date} æ‰¾åˆ°è¶³å¤Ÿæ•°æ®")
            return pd.DataFrame()

# æ”¹è¿›2: ä¼˜åŒ–ICå€¼å¤„ç†
def calculate_performance_metrics(self, results):
    # ä¸å¡«å……ICå€¼ï¼Œä¿æŒåŸå§‹é•¿åº¦
    # åœ¨åˆ†ææ—¶æ’é™¤NaNå€¼
    ic_values = [x for x in results['ic_values'] if not pd.isna(x)]
    if ic_values:
        ic_mean = np.mean(ic_values)
        ic_std = np.std(ic_values)
        # ...
```

### 5.3 ç­–ç•¥å±‚é¢

#### æ–¹æ¡ˆ1: ä¼˜åŒ–å› å­æƒé‡

```python
# å½“å‰æƒé‡
weights = {
    'alpha_peg': 0.2,
    'alpha_010': 0.2,
    'alpha_038': 0.2,
    'alpha_120cq': 0.2,
    'cr_qfq': 0.2
}

# ä¼˜åŒ–æƒé‡ (åŸºäºICè´¡çŒ®)
weights = {
    'alpha_peg': 0.15,      # ICä¸ç¨³å®š
    'alpha_010': 0.25,      # çŸ­æœŸè¶‹åŠ¿æœ‰æ•ˆ
    'alpha_038': 0.20,      # ä»·æ ¼å¼ºåº¦
    'alpha_120cq': 0.15,    # é•¿æœŸä½ç½®
    'cr_qfq': 0.25          # åŠ¨é‡å› å­
}
```

#### æ–¹æ¡ˆ2: é™ä½æ¢æ‰‹ç‡

```python
# æ–¹æ³•1: å¢åŠ æŒä»“å‘¨æœŸ
rebalance_freq = '2M'  # ä»æ¯æœˆæ”¹ä¸ºåŒæœˆ

# æ–¹æ³•2: é™ä½åˆ†ç»„æ•°é‡
groups = 3  # ä»5ç»„æ”¹ä¸º3ç»„

# æ–¹æ³•3: å¢åŠ æŒä»“é˜ˆå€¼
min_hold_days = 5  # æœ€å°‘æŒæœ‰5å¤©
```

#### æ–¹æ¡ˆ3: å¢å¼ºå› å­ç¨³å®šæ€§

```python
# æ–¹æ³•1: å› å­å¹³æ»‘
alpha_010_smooth = alpha_010.rolling(3).mean()

# æ–¹æ³•2: å¢åŠ è¿‡æ»¤æ¡ä»¶
# åªä¿ç•™IC>0çš„æ—¶æœŸ
valid_periods = df[df['IC_Value'] > 0.05]['Date'].tolist()

# æ–¹æ³•3: åŠ¨æ€æƒé‡è°ƒæ•´
if ic_ir < 0.5:
    # é™ä½è¯¥å› å­æƒé‡
    weights[factor] *= 0.5
```

---

## å…­ã€éªŒè¯å»ºè®®

### 6.1 æ•°æ®éªŒè¯

```bash
# éªŒè¯1: æ£€æŸ¥æ‰€æœ‰è°ƒä»“æ—¥æ•°æ®å®Œæ•´æ€§
python3 verify_fix.py

# éªŒè¯2: æ£€æŸ¥20241231å‰åæ•°æ®
python3 -c "
from core.utils.db_connection import db
# æŸ¥è¯¢20241231å‰åäº¤æ˜“æ—¥
"

# éªŒè¯3: æ£€æŸ¥å› å­æ•°æ®è´¨é‡
python3 -c "
# æ£€æŸ¥å„å› å­åœ¨20241231çš„å¯ç”¨æ€§
"
```

### 6.2 ç­–ç•¥éªŒè¯

```bash
# éªŒè¯1: å»¶é•¿å›æµ‹å‘¨æœŸ
# ä¿®æ”¹è„šæœ¬: end_date = '20250131'

# éªŒè¯2: ç¼©çŸ­å›æµ‹å‘¨æœŸ
# ä¿®æ”¹è„šæœ¬: end_date = '20241130'

# éªŒè¯3: ä¼˜åŒ–å‚æ•°
# æµ‹è¯•ä¸åŒæƒé‡ç»„åˆ
```

### 6.3 æ€§èƒ½éªŒè¯

```python
# éªŒè¯1: äº¤æ˜“æˆæœ¬æ•æ„Ÿæ€§
costs = [0.001, 0.0025, 0.005, 0.01]
for cost in costs:
    # é‡æ–°è®¡ç®—å‡€æ”¶ç›Š

# éªŒè¯2: æ¢æ‰‹ç‡å½±å“
turnover_sens = [0.5, 0.7, 0.9, 1.1]
for sens in turnover_sens:
    # è°ƒæ•´æ¢æ‰‹ç‡å¹¶è®¡ç®—æˆæœ¬
```

---

## ä¸ƒã€ç»“è®º

### æ ¸å¿ƒé—®é¢˜æ€»ç»“

1. **æ•°æ®é—®é¢˜**: 20241231æœŸä¸å®Œæ•´ï¼Œä½†ä¸å½±å“å‰6æœŸæœ‰æ•ˆæ€§
2. **ä»£ç é—®é¢˜**: è¾¹ç•Œæ¡ä»¶å¤„ç†éœ€ä¼˜åŒ–ï¼Œç±»å‹è½¬æ¢å·²ä¿®å¤
3. **ç­–ç•¥é—®é¢˜**:
   - å› å­æœ‰æ•ˆä½†ä¸ç¨³å®š (ICIR=0.45)
   - æ¢æ‰‹ç‡è¿‡é«˜ (90.4%)ï¼Œæˆæœ¬ä¾µèš€æ”¶ç›Š
   - å¤šç©ºç»„åˆåˆ†å±‚æ•ˆæœå¼±

### å¯è¡Œæ€§è¯„ä¼°

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| æ•°æ®è´¨é‡ | 8/10 | é™¤20241231å¤–å®Œæ•´ |
| ä»£ç è´¨é‡ | 7/10 | é€»è¾‘æ­£ç¡®ï¼Œè¾¹ç•Œéœ€ä¼˜åŒ– |
| å› å­æœ‰æ•ˆæ€§ | 6/10 | æœ‰æ•ˆä½†ä¸ç¨³å®š |
| ç­–ç•¥è¡¨ç° | 5/10 | è·‘èµ¢åŸºå‡†ä½†å¤šç©ºå¼± |
| æ•´ä½“å¯è¡Œæ€§ | 6.5/10 | éœ€ä¼˜åŒ–åå¯ç”¨ |

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³ä¿®å¤**: è°ƒæ•´å›æµ‹ç»“æŸæ—¥æœŸä¸º20241130
2. **çŸ­æœŸä¼˜åŒ–**: é™ä½æ¢æ‰‹ç‡ï¼Œä¼˜åŒ–å› å­æƒé‡
3. **é•¿æœŸæ”¹è¿›**: å¢å¼ºå› å­ç¨³å®šæ€§ï¼Œå¢åŠ é£æ§æœºåˆ¶

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-01-01
**åˆ†æå·¥å…·**: Python + Pandas + SQL
**æ•°æ®æ¥æº**: stock_database (daily_kline, index_daily_zzsz, stock_st)
