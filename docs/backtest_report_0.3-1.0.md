# 0.3-1.0版本回测报告

**回测时间**: 2025-12-24
**因子版本**: 0.3-1.0（温和吸筹）
**回测周期**: 2024-08-01 ~ 2025-03-01
**持有期**: 10天（T+11卖出）

---

## 一、因子信号统计

### 总体统计
```
总信号数: 791个
信号比例: 0.117%
数据总量: 678,960条
信号日期: 2024-11-07 ~ 2025-02-28
```

### 信号月份分布

| 月份 | 信号数 | 占比 | 累计 |
|------|--------|------|------|
| 2024-08 | 0 | 0.0% | 0 |
| 2024-09 | 0 | 0.0% | 0 |
| 2024-10 | 0 | 0.0% | 0 |
| 2024-11 | 631 | 79.8% | 631 |
| 2024-12 | 32 | 4.0% | 663 |
| 2025-01 | 19 | 2.4% | 682 |
| 2025-02 | 109 | 13.8% | 791 |

**关键发现**：
- ❌ **8-10月仍无信号**（市场环境问题）
- ✅ 11月信号集中（79.8%），市场活跃期
- ⚠️ 12-1月信号偏少（6.4%），市场调整期
- ✅ 2月信号回升（13.8%），节后恢复

---

## 二、完整回测结果（vectorbt）

### 核心指标

| 指标 | 数值 | 评价 |
|------|------|------|
| **总收益率** | -0.1056% | ❌ 亏损 |
| **年化收益率** | -0.2534% | ❌ 亏损 |
| **胜率** | 32.43% | ❌ 偏低 |
| **盈亏比** | 0.71 | ❌ <1.0，亏损放大 |
| **最大回撤** | -0.80% | ✅ 较小 |
| **夏普比率** | -0.50 | ❌ 负值 |
| **波动率** | 1.43% | ✅ 较低 |
| **总交易次数** | 589 | - |
| **盈利交易** | 191 | - |
| **亏损交易** | 397 | - |
| **平均盈利** | 7,779 | - |
| **平均亏损** | -5,286 | - |

### 与基准对比（000300.SH）

| 指标 | 数值 |
|------|------|
| **基准总收益** | +14.13% |
| **超额收益** | -14.24% ❌ |
| **超额收益（年化）** | -42.48% ❌ |

### 详细分析

**信号转化率**: 791个信号 → 589笔交易（74.5%）

**交易分布**:
- 亏损交易占比: 67.4% (397/589)
- 盈利交易占比: 32.4% (191/589)
- 盈亏比: 0.71（每亏损1元，仅赚回0.71元）

**关键发现**：
1. **策略完全失效**：跑输基准14.24%，产生负alpha
2. **胜率过低**：仅32.4%，远低于预期的55%+
3. **盈亏比<1.0**：赚小亏大模式，最危险的策略类型
4. **亏损交易是盈利的2倍**：397 vs 191

### 部分周期统计（快速回测补充）

| 周期 | 信号数 | 交易数 | 平均收益 | 胜率 | 超额收益 |
|------|--------|--------|----------|------|----------|
| 11月汇总 | 618 | 618 | -2.50% | 25.0% | +3.09% |
| 12月汇总 | 20 | 20 | -8.50% | 20.0% | -10.0% |
| 1月汇总 | 5 | 5 | -6.50% | 0.0% | -6.5% |

**趋势**：越往后表现越差，12-1月全部亏损

---

## 三、与原V3对比

### 信号数量对比

| 月份 | 原V3 | 0.3-1.0 | 减少 | 完成度 |
|------|------|---------|------|--------|
| 11月 | 1,290 | 631 | 659 (49%) | 49% |
| 12月 | 124 | 32 | 92 (74%) | 26% |
| 1月 | 82 | 19 | 63 (77%) | 23% |
| 2月 | 328 | 109 | 219 (67%) | 33% |
| **总计** | **1,824** | **791** | **1,033 (57%)** | **43%** |

### 质量对比（基于部分数据）

| 指标 | 原V3 | 0.3-1.0 | 变化 |
|------|------|---------|------|
| 信号数量 | 1,824 | 791 | -57% |
| 11月占比 | 70.7% | 79.8% | +9.1% |
| 12-2月占比 | 29.3% | 20.2% | -9.1% |
| 预期胜率 | 50% | 55%+ | +5%+ |
| 预期盈亏比 | 1.66 | 1.7+ | +0.04+ |

---

## 四、问题分析

### 1. 8-10月无信号
**原因**：市场整体低波动
- 2024年8-10月市场极度低迷
- 换手率和波动率双低
- 所有版本均无信号

**解决方案**：
- 增加市场状态过滤
- 低波动期暂停交易
- 避免在无效市场强行交易

### 2. 12-1月信号偏少
**原因**：阈值偏严格
- 0.3-1.0区间排除大量信号
- 市场调整期，符合条件的股票少

**影响**：
- 信号数量减少57%
- 可能错过部分有效机会

**权衡**：
- 优点：排除噪音，质量提升
- 缺点：机会成本增加

### 3. 收益表现不稳定
**观察**：
- 11月：部分周期正收益，整体负收益
- 12月：大部分周期负收益
- 1月：全部负收益

**可能原因**：
- 持有期10天可能过长
- 需要结合市场状态调整
- 个别极端值影响（如11-25的+62.65%）

---

## 五、改进建议

### 短期优化
1. **调整阈值**
   - 测试0.2-1.0（更宽松）
   - 或0.4-1.0（更保守）

2. **增加市场过滤**
   ```python
   # 当市场波动率低于阈值时，不发信号
   if market_volatility < 0.5:
       skip_trading = True
   ```

3. **缩短持有期**
   - 从10天改为5-7天
   - 减少市场风险暴露

### 中期优化
1. **动态参数**
   - 根据近期表现调整阈值
   - 自适应市场变化

2. **结合价格形态**
   - 增加突破、回踩等条件
   - 提高信号质量

3. **行业/市值过滤**
   - 排除特定行业
   - 聚焦特定市值区间

---

## 六、核心问题诊断

### 问题1：胜率过低（32.4%）
**原因**：
- 因子逻辑：温和吸筹阶段，股价可能继续下跌
- 持有期固定：T+11可能过长，无法及时止损
- 市场环境：8-10月无信号，11-12月市场调整

### 问题2：盈亏比<1.0（0.71）
**原因**：
- 亏损交易平均-5,286，盈利交易平均+7,779
- 但亏损交易数量是盈利的2倍
- **赚小钱、亏大钱**，这是最危险的模式

### 问题3：超额收益为负（-14.24%）
**原因**：
- 策略收益 -0.11% < 基准 +14.13%
- 在牛市中跑输大盘，说明因子方向可能错误
- "温和吸筹"阶段股价可能横盘或微跌，错过主升浪

---

## 七、最终结论

### 核心发现 ❌
1. **0.3-1.0版本因子在实际回测中完全失效**
   - 总收益-0.11%，基准+14.13%，超额-14.24%
   - 胜率仅32.4%，盈亏比仅0.71
   - 亏损交易数量是盈利的2倍

2. **与预期严重不符**
   - 预期胜率55%+，实际32.4%
   - 预期盈亏比1.7+，实际0.71
   - 预期超额收益为正，实际-14.24%

3. **因子逻辑可能存在问题**
   - "温和吸筹"阶段股价可能继续下跌
   - 10天持有期过长，无法及时止损
   - 未考虑市场整体趋势

### 问题根源
| 问题 | 可能原因 | 影响程度 |
|------|----------|----------|
| **因子定义错误** | 吸筹≠上涨 | 🔴 严重 |
| **持有期过长** | 10天无法止损 | 🔴 严重 |
| **市场环境** | 8-10月无信号 | 🟡 中等 |
| **阈值设置** | 0.3-1.0范围过宽 | 🟡 中等 |
| **未考虑趋势** | 逆势交易 | 🔴 严重 |

### 推荐度
**⭐ (1/5) - 不推荐使用**

**原因**：
1. 跑输基准14.24%，完全失效
2. 亏损交易占比67.4%，心理压力大
3. 盈亏比<1.0，赚小亏大模式
4. 与原V3相比无改进，反而更差

---

## 八、改进建议

### 立即停止 ❌
**当前版本不建议继续优化或实盘**

### 如果必须改进，考虑以下方向

#### 1. 重新定义因子逻辑
```python
# 问题：温和吸筹≠股价上涨
# 改进：增加价格确认条件

# 原逻辑
if volatility_shrink and turnover_increase:
    signal = 1

# 改进逻辑
if volatility_shrink and turnover_increase:
    # 增加价格确认：突破短期均线
    if close > ma_5:
        signal = 1
```

#### 2. 缩短持有期
- 从10天改为3-5天
- 减少市场风险暴露
- 及时止损

#### 3. 增加市场过滤
```python
# 只在特定市场环境下交易
if market_trend == "bull":
    # 可交易
    pass
else:
    # 不交易
    skip()
```

#### 4. 动态阈值调整
- 根据近期表现自动调整参数
- 如果连续亏损，暂停交易或收紧阈值

#### 5. 结合其他因子
- 增加动量因子确认
- 增加趋势因子过滤
- 多因子共振

---

## 九、实验记录

### 回测环境
- **Python**: 3.12
- **vectorbt**: 0.28.2
- **pandas**: 2.2.0
- **numpy**: 1.26.0

### 数据来源
- 股票数据: daily_kline表
- 基准数据: index_daily_zzsz表（000300.SH）
- 因子数据: factor_v3_opt_0.3_1.0_results.csv

### 文件输出
- 结果文件: `/results/backtest/backtest_vectorbt_results.csv`
- 交易记录: `/results/backtest/backtest_vectorbt_trades.csv`
- 详细报告: `backtest_report_vectorbt_0.3-1.0.md`

---

## 十、总结

### 关键教训
1. **回测≠实盘**：即使使用专业工具vectorbt，策略仍可能失效
2. **预期≠现实**：理论指标（胜率55%、盈亏比1.7）与实际（32.4%、0.71）差距巨大
3. **因子逻辑需验证**：温和吸筹阶段股价可能不涨反跌
4. **市场环境重要性**：8-10月无信号，11-12月市场调整，策略全程被动

### 下一步行动
1. **停止使用0.3-1.0版本**
2. **重新审视因子逻辑**：吸筹≠上涨，需要价格确认
3. **考虑其他版本**：测试0.2-0.5（更保守）或1.0-2.0（更激进）
4. **增加保护机制**：止损、动态仓位、市场过滤

---

**报告生成时间**: 2025-12-24
**回测工具**: vectorbt v0.28.2
**推荐状态**: ❌ 不推荐使用
**风险等级**: 🔴 高风险（负超额收益）
